@page "/character"
@inherits NullablePageBase<CharacterOptions>
@{PageTitle = "Character Generator";}

<h3>Characters</h3>

@if (Model != null)
{
    <div>
        <EditForm Model="@Model">

            <DataAnnotationsValidator />
            <ValidationSummary />

            <div>This is used for creating NPCs only. Certain liberties where taken with the rules to allow for random character generation.</div>
            <table class="gridtable">
                <tr>
                    <th>Species</th>
                    <td colspan="4">
                        <InputSelect @bind-Value="Model.Species">
                            <option value="" selected="@(string.IsNullOrEmpty(Model.Species))">(Random)</option>
                            @foreach (var item in Model.SpeciesList)
                            {
                                <option value="@(item)" selected="@(Model.Species == item)"> @(item)</option>
                            }
                        </InputSelect>
                    </td>
                </tr>
                <tr>
                    <th>First Career</th>
                    <td>
                        <InputSelect @bind-Value="Model.FirstCareer">
                            <option value="" selected="@(string.IsNullOrEmpty(Model.FirstCareer))">(Random)</option>
                            @foreach (var item in Model.CareerList)
                                {
                                <option value="@(item)" selected="@(Model.FirstCareer == item)"> @(item)</option>
                                }
                        </InputSelect>
                    </td>
                    <th>First Assignment</th>
                    <td>
                        <InputSelect @bind-Value="Model.FirstAssignment">
                            <option value="" selected="@(string.IsNullOrEmpty(Model.FirstAssignment))">(Random)</option>
                            @foreach (var item in Model.FirstAssignmentList)
                                {
                                <option value="@(item)" selected="@(Model.FirstAssignment == item)"> @(item)</option>
                                }
                        </InputSelect>
                    </td>
                </tr>
                <tr>
                    <th title="Final career is not guaranteed.">Desired final Career</th>
                    <td>
                        <InputSelect @bind-Value="Model.FinalCareer">
                            <option value="" selected="@(string.IsNullOrEmpty(Model.FinalCareer))">(Random)</option>
                            @foreach (var item in Model.CareerList)
                                {
                                <option value="@(item)" selected="@(Model.FinalCareer == item)"> @(item)</option>
                                }
                        </InputSelect>
                    </td>
                    <th title="Final assignment is not guaranteed.">Desired final Assignment</th>
                    <td>
                        <InputSelect @bind-Value="Model.FinalAssignment">
                            <option value="" selected="@(string.IsNullOrEmpty(Model.FinalAssignment))">(Random)</option>
                            @foreach (var item in Model.FinalAssignmentList)
                                {
                                <option value="@(item)" selected="@(Model.FinalAssignment == item)"> @(item)</option>
                                }
                        </InputSelect>
                    </td>
                </tr>
                <tr>
                    <th>Terms</th>
                    <td>
                        Terms <InputSelect @bind-Value="Model.Terms">
                            <option value="" selected="@(string.IsNullOrEmpty(Model.TermsCode))">(Random)</option>
                            @foreach (var item in Model.AgeList)
                                {
                                <option value="@(item.ToString())" selected="@( item == Model.Terms )">@item</option>
                                }
                        </InputSelect>
                    </td>
                    <th>Gender</th>
                    <td>
                        <InputSelect @bind-Value="Model.Gender">
                            <option value="" selected="@(Model.Gender == "")"></option>
                            <option value="M" selected="@(Model.Gender == "M")">M</option>
                            <option value="F" selected="@(Model.Gender == "F")">F</option>
                        </InputSelect>
                    </td>
                </tr>
                <tr>
                    <th>Age</th>
                    <td>
                        <label title="When checked and two characters are viable, use the younger one.">
                            <InputCheckbox @bind-Value="Model.PreferYounger" />
                            Prefer Younger
                        </label>
                    </td>
                    <td colspan="2"/>
                </tr>
                <tr>
                    <th title="Prefer a character with positive or negative DMs to the following stats.">Desired Stats</th>
                    <td colspan="4">
                        <table>
                            <tr>
                                <td>
                                    STR
                                </td>
                                <td>
                                    <InputSelect @bind-Value="Model.Str">
                                        <option value="" selected="@(Model.Str == "")"></option>
                                        <option value="High" selected="@(Model.Str == "High")">High</option>
                                        <option value="Low" selected="@(Model.Str == "Low")">Low</option>
                                    </InputSelect>
                                </td>
                                <td>
                                    DEX
                                </td>
                                <td>

                                    <InputSelect @bind-Value="Model.Dex">
                                        <option value="" selected="@(Model.Dex == "")"></option>
                                        <option value="High" selected="@(Model.Dex == "High")">High</option>
                                        <option value="Low" selected="@(Model.Dex == "Low")">Low</option>
                                    </InputSelect>
                                </td>
                                <td>
                                    END
                                </td>
                                <td>

                                    <InputSelect @bind-Value="Model.End">
                                        <option value="" selected="@(Model.End == "")"></option>
                                        <option value="High" selected="@(Model.End == "High")">High</option>
                                        <option value="Low" selected="@(Model.End == "Low")">Low</option>
                                    </InputSelect>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    INT
                                </td>
                                <td>

                                    <InputSelect @bind-Value="Model.Int">
                                        <option value="" selected="@(Model.Int == "")"></option>
                                        <option value="High" selected="@(Model.Int == "High")">High</option>
                                        <option value="Low" selected="@(Model.Int == "Low")">Low</option>
                                    </InputSelect>
                                </td>
                                <td>
                                    EDU
                                </td>
                                <td>

                                    <InputSelect @bind-Value="Model.Edu">
                                        <option value="" selected="@(Model.Edu == "")"></option>
                                        <option value="High" selected="@(Model.Edu == "High")">High</option>
                                        <option value="Low" selected="@(Model.Edu == "Low")">Low</option>
                                    </InputSelect>
                                </td>
                                <td>
                                    SOC
                                </td>
                                <td>

                                    <InputSelect @bind-Value="Model.Soc">
                                        <option value="" selected="@(Model.Soc == "")"></option>
                                        <option value="High" selected="@(Model.Soc == "High")">High</option>
                                        <option value="Low" selected="@(Model.Soc == "Low")">Low</option>
                                    </InputSelect>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <th title="Prefer a character with the following skills.">Desired Skills</th>
                    <td colspan="3">
                        <InputSelect @bind-Value="Model.SkillA">
                            <option value="" selected="@(string.IsNullOrEmpty(Model.SkillA))"></option>
                            @foreach (var item in Model.SkillList)
                                {
                                <option value="@(item.ShortName)" selected="@( !string.IsNullOrEmpty(Model.SkillA) && (Model.SkillA == item.ShortName) )"> @(item.ToString())</option>
                                }
                        </InputSelect>
                        <br />
                        <br />

                        <InputSelect @bind-Value="Model.SkillB">
                            <option value="" selected="@(string.IsNullOrEmpty(Model.SkillB))"></option>
                            @foreach (var item in Model.SkillList)
                                {
                                <option value="@(item.ShortName)" selected="@( !string.IsNullOrEmpty(Model.SkillB) && (Model.SkillB == item.ShortName) )"> @(item.ToString())</option> 
                                }
                        </InputSelect>
                        <br />
                        <br />
                        <InputSelect @bind-Value="Model.SkillC">
                            <option value="" selected="@(string.IsNullOrEmpty(Model.SkillC))"></option>
                            @foreach (var item in Model.SkillList)
                                {
                                <option value="@(item.ShortName)" selected="@( !string.IsNullOrEmpty(Model.SkillC) && (Model.SkillC == item.ShortName) )"> @(item.ToString())</option> 
                                }
                        </InputSelect>
                        <br />
                        <br />
                        <InputSelect @bind-Value="Model.SkillD">
                            <option value="" selected="@(string.IsNullOrEmpty(Model.SkillD))"></option>
                            @foreach (var item in Model.SkillList)
                                {
                                <option value="@(item.ShortName)" selected="@( !string.IsNullOrEmpty(Model.SkillD) && (Model.SkillD == item.ShortName) )"> @(item.ToString())</option> 
                                }
                        </InputSelect>
                    </td>
                </tr>
                <tr>
                    <th>Current Year</th>
                    <td><InputNumber @bind-Value="Model.Year"></InputNumber>"</td>
                    <td colspan="2"></td>
                </tr>
                <tr>
                    <td colspan="5" style="text-align:center">
                        <button @onclick="GenerateCharacter">Generate Character</button>
                    </td>
                </tr>
                <tr><td colspan="4">When using a "desired" option, 500 characters will be created and then the best match selected.</td></tr>
            </table>
        </EditForm>
    </div>
    @foreach (var character in Characters)
    {
        <hr />
        <CharacterViewer Character="@character" />

    }
}
else if (LoadFailed)
{
    <h1>Error loading page.</h1>
}
else
{
    <h1>Loading</h1>
}
